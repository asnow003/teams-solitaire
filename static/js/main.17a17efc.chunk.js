(this["webpackJsonpmicrosoft-teams-app"]=this["webpackJsonpmicrosoft-teams-app"]||[]).push([[0],{15:function(t,i,e){},16:function(t,i,e){"use strict";e.r(i);var s,n=e(4),a=e(6),o=e.n(a),h=e(9),r=e.n(h),c=(e(15),e(8),e(5)),l=e(1),u=e(0),d=e(3),v=e(2);!function(t){t[t.Move=0]="Move",t[t.Down=1]="Down",t[t.Up=2]="Up",t[t.Hover=3]="Hover",t[t.Click=4]="Click"}(s||(s={}));var f=function(){function t(i,e,s){var n=this;Object(l.a)(this,t),this.isRunning=!1,this.settings=void 0,this.canvas=void 0,this.context=void 0,this.resizeTimer=void 0,this.scenes=void 0,this.activeSceneId=void 0,this.resizeCanvas=function(){n.resizeTimer&&clearTimeout(n.resizeTimer),n.resizeTimer=setTimeout((function(){n.canvas&&(n.settings.reload(),n.settings.isMaximized?(n.canvas.style.background="#f3f2f1",n.canvas.width=document.documentElement.clientWidth,n.canvas.height=document.documentElement.clientHeight):(n.canvas.style.background=n.settings.backgroundColor,n.canvas.width=n.settings.width,n.canvas.height=n.settings.height))}),250)},this.run=function(){n.isRunning&&(n.context&&n.update(n.context),window.requestAnimationFrame(n.run))},this.settings=i,this.scenes=e,this.activeSceneId=s}return Object(u.a)(t,[{key:"init",value:function(){var t=this;return this.canvas=document.getElementById(this.settings.canvasId),this.context=this.canvas.getContext("2d"),this.scenes.forEach((function(i){i.changeScene=function(i){t.changeScene(i)},i.restart=function(){t.restart()}})),this.canvas.addEventListener("click",(function(i){var e=t.getMousePosition(i);e&&t.scenes.forEach((function(t){e.type=s.Click,t.onMouseEvent(e)}))}),!1),this.canvas.addEventListener("mousedown",(function(i){var e=t.getMousePosition(i);e&&t.scenes.forEach((function(t){e.type=s.Down,t.onMouseEvent(e)}))}),!1),this.canvas.addEventListener("mouseup",(function(i){var e=t.getMousePosition(i);e&&(e.type=s.Up,t.scenes.forEach((function(t){t.onMouseEvent(e)})))}),!1),this.canvas.addEventListener("mousemove",(function(i){var e=t.getMousePosition(i);e&&(e.type=s.Move,t.scenes.forEach((function(t){t.onMouseEvent(e)})))}),!1),window.addEventListener("resize",this.resizeCanvas,!1),this.resizeCanvas(),this.context}},{key:"getMousePosition",value:function(t){if(this.canvas){var i=this.canvas.getBoundingClientRect(),e=t.clientX-i.left,s=t.clientY-i.top;return{x:e/this.settings.scaleX-this.settings.leftOffset,y:s/this.settings.scaleY-this.settings.topOffset,type:void 0}}}},{key:"start",value:function(){var t=this,i=this.init();this.isRunning=!0,this.scenes.forEach((function(e){e.sceneId===t.activeSceneId&&e.start(t.settings,i)})),this.run()}},{key:"pause",value:function(){var t=this;this.isRunning=!1,this.scenes.forEach((function(i){i.sceneId===t.activeSceneId&&i.pause()}))}},{key:"unPause",value:function(){var t=this;this.isRunning||(this.isRunning=!0,this.scenes.forEach((function(i){i.sceneId===t.activeSceneId&&i.unPause()})),this.run())}},{key:"restart",value:function(){this.stop(),this.start()}},{key:"stop",value:function(){var t=this;this.isRunning=!1,this.context&&this.scenes.forEach((function(i){i.sceneId===t.activeSceneId&&i.stop(t.context)}))}},{key:"changeScene",value:function(t){var i=this;this.scenes.forEach((function(e){e.sceneId===t&&(i.stop(),i.activeSceneId=t,i.start())}))}},{key:"updateSettings",value:function(){this.settings.reload()}},{key:"drawGrid",value:function(t){if(this.context){this.context.save(),this.context.globalAlpha=.2;for(var i=O.gameHeight/t,e=1;e<i;e++)this.context.beginPath(),this.context.strokeStyle="red",this.context.moveTo(0,e*t),this.context.lineTo(O.gameWidth,e*t),this.context.stroke();for(var s=O.gameWidth/t,n=1;n<s;n++)this.context.beginPath(),this.context.strokeStyle="blue",this.context.moveTo(n*t,0),this.context.lineTo(n*t,O.gameHeight),this.context.stroke();this.context.restore()}}},{key:"update",value:function(t){var i=this;this.canvas&&(t.clearRect(0,0,this.canvas.width,this.canvas.height),t.save(),this.isRunning=!0,t.scale(this.settings.scaleX,this.settings.scaleY),t.translate(this.settings.leftOffset,this.settings.topOffset),this.settings.isMaximized&&(t.fillStyle=this.settings.backgroundColor,t.fillRect(0,0,O.gameWidth,O.gameHeight)),O.isDebug&&this.drawGrid(25),this.scenes.forEach((function(e){e.sceneId===i.activeSceneId&&e.update(t)})),t.restore())}}]),t}(),g=function(){function t(i,e,s,n,a){Object(l.a)(this,t),this.playAreaWidth=void 0,this.playAreaHeight=void 0,this.width=void 0,this.height=void 0,this.isMaximized=void 0,this.backgroundColor=void 0,this.canvasId=void 0,this.leftOffset=0,this.topOffset=0,this.scaleX=1,this.scaleY=1,this.playAreaWidth=e,this.playAreaHeight=s,this.canvasId=i,this.width=e,this.height=s,this.isMaximized=n,this.backgroundColor=a,this.updateSettings()}return Object(u.a)(t,[{key:"updateSettings",value:function(){var t=document.documentElement.clientWidth,i=document.documentElement.clientHeight;if(this.scaleX=1,this.scaleY=1,this.leftOffset=0,this.topOffset=0,this.isMaximized){var e=t,s=i;t>i?(e=i*this.playAreaWidth/this.playAreaHeight,this.leftOffset=(t-e)/2):(s=t*this.playAreaHeight/this.playAreaWidth,this.topOffset=(i-s)/2),this.width=e,this.height=s,this.scaleX=e/this.playAreaWidth,this.scaleY=s/this.playAreaHeight,this.leftOffset=this.leftOffset/this.scaleX,this.topOffset=this.topOffset/this.scaleY}}},{key:"reload",value:function(){this.updateSettings()}}]),t}(),k=function t(i,e){Object(l.a)(this,t),this.x=void 0,this.y=void 0,this.x=i,this.y=e},p=function(){function t(i){Object(l.a)(this,t),this.settings=void 0,this.dragOffsetPosition=void 0,this._id=void 0,this._mouseInArea=!1,this._isDragging=!1,this._isMoving=!1,this._moveSpeed=10,this._moveToPosition=void 0,this._visible=!0,this._isClickable=!1,this._isDragable=!1,this._left=0,this._top=0,this._width=0,this._height=0,this._group=void 0,this._collider=void 0,this._id=i}return Object(u.a)(t,[{key:"Id",get:function(){return this._id}},{key:"IsDragging",get:function(){return this._isDragging}},{key:"IsMoving",get:function(){return this._isMoving}},{key:"Visible",get:function(){return this._visible},set:function(t){this._visible=t}},{key:"IsClickable",get:function(){return this._isClickable},set:function(t){this._isClickable=t}},{key:"IsDragable",get:function(){return this._isDragable},set:function(t){this._isDragable=t}},{key:"Left",get:function(){return this._left},set:function(t){this._left=t,this._collider&&(this._collider.Left=this._left)}},{key:"Top",get:function(){return this._top},set:function(t){this._top=t,this._collider&&(this._collider.Top=this._top)}},{key:"Width",get:function(){return this._width},set:function(t){this._width=t,this._collider&&(this._collider.Width=this._width)}},{key:"Height",get:function(){return this._height},set:function(t){this._height=t,this._collider&&(this._collider.Height=this._height)}},{key:"Group",get:function(){return this._group},set:function(t){this._group=t}},{key:"Collider",get:function(){return this._collider},set:function(t){this._collider=t}}]),Object(u.a)(t,[{key:"onMouse",value:function(t){if(t.type===s.Up&&this._isDragging&&(this._isDragging=!1,this.onDragStop(this),this.onDrop(t)),this._isDragging&&(this.setMouseCursorDragging(),this.dragOffsetPosition)){var i=t.x-this.dragOffsetPosition.x,e=t.y-this.dragOffsetPosition.y;i<0?i=0:this.settings&&i>this.settings.playAreaWidth-this.Width&&(i=this.settings.playAreaWidth-this.Width),this.Left=i,e<0?e=0:this.settings&&e>this.settings.playAreaHeight-this.Height&&(e=this.settings.playAreaHeight-this.Height),this.Top=e,this.onDragging({x:i,y:e})}this.Visible?(this.IsClickable&&this.setMouseCursorClickable(),this.IsDragable&&!this._isDragging&&this.setMouseCursorDragable(),this.IsDragable&&t.type===s.Down&&(this.setMouseCursorDragging(),this.dragOffsetPosition=new k(t.x-this.Left,t.y-this.Top),this._isDragging=!0,this.onDragStart(this),this.onDrag(t)),this._isClickable&&t.type===s.Down&&(t.type=s.Click,this.onClick(t)),t.type===s.Up&&this._isDragging&&(this.dragOffsetPosition=void 0,this._isDragging=!1,this.onDrop(t)),this._mouseInArea||(this._mouseInArea=!0)):this._mouseInArea&&(this._mouseInArea=!1,this.resetMouseCursor())}},{key:"onEnter",value:function(t){}},{key:"onLeave",value:function(t){}},{key:"onClick",value:function(t){}},{key:"onMove",value:function(t){}},{key:"onMoving",value:function(t){}},{key:"onMoved",value:function(){}},{key:"onDrag",value:function(t){}},{key:"onDrop",value:function(t){}},{key:"onDragging",value:function(t){}},{key:"onCollisionEnter",value:function(t){}},{key:"onCollisionLeave",value:function(t){}},{key:"onCursorChange",value:function(t){}},{key:"onDragStart",value:function(t){}},{key:"onDragStop",value:function(t){}},{key:"setMouseCursorClickable",value:function(){this.onCursorChange("pointer")}},{key:"setMouseCursorDragable",value:function(){this.onCursorChange("grab")}},{key:"setMouseCursorDragging",value:function(){this.onCursorChange("grabbing")}},{key:"resetMouseCursor",value:function(){this.onCursorChange("auto")}},{key:"onUpdate",value:function(t,i){if(this.settings=i,this._moveToPosition){var e=!1,s=!1,n=this._moveToPosition.x,a=Math.abs(this.Left-n),o=this._moveToPosition.y,h=Math.abs(this.Top-o),r=this._moveSpeed,c=this._moveSpeed;if(a>h?c*=h/a:r*=a/h,a>r){var l=this.Left<n?1:-1;this.Left=this.Left+r*l}else e=!0,this.Left=n;if(h>c){var u=this.Top<o?1:-1;this.Top=this.Top+c*u}else s=!0,this.Top=o;e&&s?(this._moveToPosition=void 0,this.onMoved()):this.onMoving({x:this.Left,y:this.Top})}}},{key:"moveTo",value:function(t,i){this._moveSpeed=i,this._moveToPosition=t,this.onMove(t)}},{key:"roundedRect",value:function(t,i,e,s,n,a){t.beginPath(),t.arc(i+a,e+a,a,Math.PI,1.5*Math.PI),t.arc(i+s-a,e+a,a,1.5*Math.PI,2*Math.PI),t.arc(i+s-a,e+n-a,a,0,.5*Math.PI),t.arc(i+a,e+n-a,a,.5*Math.PI,Math.PI),t.closePath()}},{key:"createText",value:function(t,i,e,s,n){t.font="".concat(e,"px Arial"),t.fillStyle="black",t.fillText(i,s,n)}}]),t}(),y=function(t){Object(d.a)(e,t);var i=Object(v.a)(e);function e(){var t;Object(l.a)(this,e);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return(t=i.call.apply(i,[this].concat(n)))._behaviors=new Array,t}return Object(u.a)(e,[{key:"onEnter",value:function(t){}},{key:"onLeave",value:function(t){}},{key:"onClick",value:function(t){}},{key:"onMoved",value:function(){}},{key:"onDrag",value:function(t){}},{key:"onDrop",value:function(t){}},{key:"start",value:function(t){}},{key:"stop",value:function(t){}},{key:"update",value:function(t){}},{key:"onCollisionEnter",value:function(t){}},{key:"onCollisionLeave",value:function(t){}},{key:"add",value:function(t){t.Left=this.Left,t.Top=this.Top,t.Group=this,this._behaviors.push(t)}},{key:"remove",value:function(t){var i=this._behaviors.indexOf(t);i>=0&&(t.Group=void 0,this._behaviors.splice(i,1))}},{key:"contains",value:function(t){return this._behaviors.indexOf(t)>=0}},{key:"reset",value:function(){var t=this._behaviors;return this._behaviors=new Array,t}},{key:"Behaviors",get:function(){return this._behaviors}}]),e}(p),C=function(){function t(i){Object(l.a)(this,t),this.sceneId=void 0,this.behaviors=void 0,this.collisions={},this.draggingItem=void 0,this.settings=void 0,this.context=void 0,this.currentInAreaBehavior=void 0,this.sceneId=i,this.behaviors=new Array}return Object(u.a)(t,[{key:"emitCollisions",value:function(t){if(void 0!==t.Collider){var i=new Array,e=this.collisions[t.Id];this.behaviors.forEach((function(s){if(s.Visible&&t.Id!==s.Id&&t.Collider&&t.Collider.Enabled&&s.Collider&&s.Collider.Enabled&&t.Collider.hasCollided(s.Collider))if(i.push(s),!e||e.indexOf(s)<0)t.onCollisionEnter(s),s.onCollisionEnter(t);else if(e){var n=e.indexOf(s);n>-1&&e.splice(n,1)}})),e&&e.length>0&&e.forEach((function(i){t.onCollisionLeave(i),i.onCollisionLeave(t)})),this.collisions[t.Id]=i}}},{key:"emitBehaviorStart",value:function(t,i){var e=this;t.start(i),t.onDragStart=function(t){e.draggingItem=t},t.onDragStop=function(t){e.draggingItem=void 0}}},{key:"start",value:function(t,i){var e=this;this.context=i,this.settings=t,this.behaviors=new Array,this.init(i),this.behaviors.forEach((function(t){t instanceof p&&(e.emitBehaviorStart(t,i),t instanceof y&&t.Behaviors.forEach((function(t){e.emitBehaviorStart(t,i)})))}))}},{key:"emitBehaviorStop",value:function(t,i){t.stop(i),t.onDragStart=function(t){},t.onDragStop=function(t){}}},{key:"stop",value:function(t){var i=this;this.behaviors.forEach((function(e){e instanceof p&&(i.emitBehaviorStop(e,t),e instanceof y&&e.Behaviors.forEach((function(e){i.emitBehaviorStop(e,t)})))}))}},{key:"emitBehaviorUpdate",value:function(t,i){var e=this;t.Visible&&(i.save(),t.update(i),t.onUpdate(i,this.settings),t.onCursorChange=function(t){if(e.settings){var i=document.getElementById(e.settings.canvasId);i&&(i.style.cursor=t)}},this.emitCollisions(t),i.restore())}},{key:"onUpdate",value:function(t){}},{key:"update",value:function(t){var i=this;this.behaviors.forEach((function(e){e instanceof p&&(e.IsDragging||i.emitBehaviorUpdate(e,t),e instanceof y&&e.Behaviors.forEach((function(e){e.IsDragging||i.emitBehaviorUpdate(e,t)})))})),this.draggingItem&&(this.emitBehaviorUpdate(this.draggingItem,t),this.draggingItem instanceof y&&this.draggingItem.Behaviors.forEach((function(e){i.emitBehaviorUpdate(e,t)}))),this.onUpdate(t)}},{key:"sendDraggingMouseEvents",value:function(t,i){t.IsDragging&&t.onMouse(i)}},{key:"hasCollidedAtPoint",value:function(t,i,e){return i>=t.Left&&i<=t.Left+t.Width&&e>=t.Top&&e<=t.Top+t.Height}},{key:"onMouseEvent",value:function(t){var i,e=this;if(this.draggingItem&&this.sendDraggingMouseEvents(this.draggingItem,t),this.behaviors.forEach((function(s){s.Visible&&s instanceof p&&(e.hasCollidedAtPoint(s,t.x,t.y)&&(i=s),s instanceof y&&s.Behaviors.forEach((function(s){e.hasCollidedAtPoint(s,t.x,t.y)&&(i=s)})))})),i){var s;if(i.onMouse(t),i.Id!==(null===(s=this.currentInAreaBehavior)||void 0===s?void 0:s.Id)){if(this.currentInAreaBehavior&&!this.currentInAreaBehavior.IsDragging&&(this.currentInAreaBehavior.onLeave(t),this.settings)){var n=document.getElementById(this.settings.canvasId);n&&(n.style.cursor="auto")}this.currentInAreaBehavior=i,i.onEnter(t)}i=void 0}else if(this.currentInAreaBehavior&&!this.currentInAreaBehavior.IsDragging){if(this.currentInAreaBehavior.onLeave(t),this.settings){var a=document.getElementById(this.settings.canvasId);a&&(a.style.cursor="auto")}this.currentInAreaBehavior=void 0}}},{key:"addBehavior",value:function(t){this.behaviors.push(t)}},{key:"clear",value:function(){this.behaviors=new Array}},{key:"changeScene",value:function(t){}},{key:"pause",value:function(){}},{key:"unPause",value:function(){}},{key:"restart",value:function(){}}]),t}(),m=function(){function t(i,e,s,n){Object(l.a)(this,t),this._enabled=void 0,this._left=void 0,this._top=void 0,this._width=void 0,this._height=void 0,this._enabled=!0,this._left=i,this._top=e,this._width=s,this._height=n}return Object(u.a)(t,[{key:"Enabled",get:function(){return this._enabled},set:function(t){this._enabled=t}},{key:"Left",get:function(){return this._left},set:function(t){this._left=t}},{key:"Top",get:function(){return this._top},set:function(t){this._top=t}},{key:"Width",get:function(){return this._width},set:function(t){this._width=t}},{key:"Height",get:function(){return this._height},set:function(t){this._height=t}}]),Object(u.a)(t,[{key:"checkCollisionPoints",value:function(t,i){return this.hasCollidedAtPoint(t,i.Left,i.Top)||this.hasCollidedAtPoint(t,i.Left,i.Top+i.Height)||this.hasCollidedAtPoint(t,i.Left+i.Width,i.Top)||this.hasCollidedAtPoint(t,i.Left+i.Width,i.Top+i.Height)}},{key:"hasCollidedAtPoint",value:function(t,i,e){return i>=t.Left&&i<=t.Left+t.Width&&e>=t.Top&&e<=t.Top+t.Height}},{key:"hasCollided",value:function(t){return this.checkCollisionPoints(this,t)||this.checkCollisionPoints(t,this)}}]),t}(),b=function(t){Object(d.a)(e,t);var i=Object(v.a)(e);function e(t,s,n){var a;return Object(l.a)(this,e),(a=i.call(this,t))._isHighlighted=!1,a.Top=s,a.Left=n,a.Width=O.cardWidth,a.Height=O.cardHeight,a.Collider=new m(a.Left,a.Top,a.Width,a.Height),a}return Object(u.a)(e,[{key:"HasCards",get:function(){return this.Behaviors.length>0}},{key:"NumberOfCards",get:function(){return this.Behaviors.length}},{key:"IsHighlighted",get:function(){return this._isHighlighted},set:function(t){this._isHighlighted=t}},{key:"TopCard",get:function(){if(this.Behaviors.length>0)return this.Behaviors[this.Behaviors.length-1]}}]),Object(u.a)(e,[{key:"canAddCard",value:function(t){return!0}},{key:"onUpdate",value:function(t){}},{key:"update",value:function(t){this.roundedRect(t,this.Left,this.Top,this.Width,this.Height,10),t.fillStyle="transparent",t.fill(),t.strokeStyle="gray",t.lineWidth=1.2,t.stroke(),this.IsHighlighted&&this.Collider&&(this.roundedRect(t,this.Collider.Left-4,this.Collider.Top-4,this.Collider.Width+8,this.Collider.Height+8,10),t.fillStyle="transparent",t.fill(),t.strokeStyle="#29ff3b",t.setLineDash([5,3]),t.lineWidth=3,t.stroke()),O.isDebug&&(this.Collider&&this.Collider.Enabled&&(t.globalAlpha=.3,t.fillStyle="red",t.fillRect(this.Collider.Left,this.Collider.Top,this.Collider.Width,this.Collider.Height),t.globalAlpha=1),this.createText(t,"Cards ".concat(this.Behaviors.length),12,this.Left,this.Top-10),this.Collider&&this.createText(t,"Collider (".concat(Math.round(this.Collider.Left),", ").concat(Math.round(this.Collider.Top),", ").concat(this.Collider.Width,", ").concat(this.Collider.Height,")"),8,this.Left,this.Top-1)),this.onUpdate(t)}},{key:"drawCards",value:function(t,i){"undefined"===typeof t&&(t=1);for(var e=new Array,s=t;s>0;s--)if(this.Behaviors&&this.Behaviors.length>0){var n=i?this.Behaviors.shift():this.Behaviors.pop();n&&e.push(n)}return this.onDrawCards(e),this.updateStack(),e}},{key:"addCard",value:function(t){if(this.Behaviors.length>0){var i=this.Behaviors[this.Behaviors.length-1];i instanceof S&&(i.NextCard=t,t.PreviousCard=i,t.NextCard=void 0)}this.add(t),this.updateStack()}},{key:"addCards",value:function(t){var i=this;t.forEach((function(t){i.addCard(t)}))}},{key:"removeCards",value:function(t){var i=this;t.forEach((function(t){i.removeCard(t)}))}},{key:"removeCard",value:function(t){this.remove(t),this.updateStack()}},{key:"onDrawCards",value:function(t){}},{key:"updateStack",value:function(){}}]),e}(y),I=function(t){Object(d.a)(e,t);var i=Object(v.a)(e);function e(){var t;Object(l.a)(this,e);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return(t=i.call.apply(i,[this].concat(n)))._isReady=!1,t}return Object(u.a)(e,[{key:"canAddCard",value:function(t){if(t.Group&&t.Group.Id===this.Id)return!1;var i=this.TopCard;return 0===this.Behaviors.length?13===t.Rank:!!i&&(t.Rank===i.Rank-1&&i.IsRed!==t.IsRed)}},{key:"onCollisionEnter",value:function(t){t instanceof S&&(this.IsHighlighted=this.canAddCard(t))}},{key:"onCollisionLeave",value:function(t){this.IsHighlighted=!1}},{key:"updateStack",value:function(){if(this.IsReady){this.TopCard&&(this.TopCard.IsDragable=!0,this.TopCard.IsFaceUp=!0);var t=0,i=0;this.Collider&&(t=this.Height,i=this.Width);for(var e=0;e<this.Behaviors.length;e++){var s=this.Behaviors[e];if(s instanceof S&&(s.ParentStackIsPlay=!0,s.PreviousCard=void 0,s.NextCard=void 0),e>0){var n=this.Behaviors[e-1];if(s instanceof S&&n instanceof S){var a=n.IsFaceUp?40:15;this.Behaviors[e].Top=n.Top+a,s.PreviousCard=n}}if(e<this.Behaviors.length-1&&s instanceof S){var o=this.Behaviors[e+1];o instanceof S&&(s.NextCard=o)}if(this.Collider&&s.Collider){var h=s.Top-this._top+this._height;h>t&&(t=h);var r=s.Left-this._left+this._width;r>i&&(i=r)}}this.Collider&&(this.Collider.Height=t,this.Collider.Width=i)}}},{key:"IsReady",get:function(){return this._isReady},set:function(t){this._isReady=t}}]),e}(b),S=function(t){Object(d.a)(e,t);var i=Object(v.a)(e);function e(t,s,n){var a;return Object(l.a)(this,e),(a=i.call(this,t))._suit=void 0,a._rank=void 0,a.collisions=void 0,a._isFaceUp=!1,a._previousCard=void 0,a._nextCard=void 0,a._parentStackIsPlay=!1,a.origPosition=void 0,a.collisions=new Array,a._suit=s,a._rank=n,a.Left=0,a.Top=0,a.Width=O.cardWidth,a.Height=O.cardHeight,a.Collider=new m(a.Left,a.Top,a.Width,a.Height),a.Collider.Enabled=!1,a}return Object(u.a)(e,[{key:"Suit",get:function(){return this._suit}},{key:"Rank",get:function(){return this._rank}},{key:"IsFaceUp",get:function(){return this._isFaceUp},set:function(t){this._isFaceUp=t}},{key:"Description",get:function(){var t="";switch(this._suit){case 1:t="Clubs";break;case 2:t="Diamonds";break;case 3:t="Hearts";break;case 4:t="Spades"}var i="";switch(this._rank){case 11:i="Jack";break;case 12:i="Queen";break;case 13:i="King";break;case 14:i="Ace";break;default:i=this._rank.toString()}return"".concat(i," of ").concat(t)}},{key:"IsAce",get:function(){return 14===this._rank}},{key:"IsRed",get:function(){return 2===this._suit||3===this._suit}},{key:"IsBlack",get:function(){return 1===this._suit||4===this._suit}},{key:"PreviousCard",get:function(){return this._previousCard},set:function(t){this._previousCard=t}},{key:"NextCard",get:function(){return this._nextCard},set:function(t){this._nextCard=t}},{key:"ParentStackIsPlay",get:function(){return this._parentStackIsPlay},set:function(t){this._parentStackIsPlay=t}}]),Object(u.a)(e,[{key:"start",value:function(t){}},{key:"stop",value:function(t){}},{key:"onEnter",value:function(t){}},{key:"onLeave",value:function(t){}},{key:"onClick",value:function(t){}},{key:"onDrag",value:function(t){if(this.origPosition=new k(this.Left,this.Top),this.Collider&&(this.Collider.Enabled=!0),this.ParentStackIsPlay)for(var i=this.NextCard;i;)this.add(i),i=i.NextCard}},{key:"onDragging",value:function(t){var i=40;this.Behaviors.forEach((function(e){e.Left=t.x,e.Top=t.y+i,i+=40}))}},{key:"onMove",value:function(t){var i=40;if(this.ParentStackIsPlay)for(var e=this.NextCard;e;)e.Left=t.x,e.Top=t.y+i,e=e.NextCard,i+=40}},{key:"onMoving",value:function(t){var i=40;this.Behaviors.forEach((function(e){e.Left=t.x,e.Top=t.y+i,i+=40}))}},{key:"onMoved",value:function(){this.reset()}},{key:"onDrop",value:function(t){var i=void 0;if(this.Collider&&(this.Collider.Enabled=!1),this.collisions.length>0&&(i=this.collisions[this.collisions.length-1]),i&&i instanceof b&&i.canAddCard(this)){var e=new Array;if(e.push(this),this.Group&&this.Group instanceof b){if(this.Group instanceof I)for(var s=this.NextCard;s;)e.push(s),s=s.NextCard;this.Group.removeCards(e),i.addCards(e)}B.Moves=B.Moves+1}else this.origPosition&&(this.moveTo(this.origPosition,60),this.origPosition=void 0);this.collisions=new Array,this.reset()}},{key:"onCollisionEnter",value:function(t){var i=this.collisions.indexOf(t);i>=0&&this.collisions.splice(i,1),this.collisions.push(t)}},{key:"onCollisionLeave",value:function(t){var i=this.collisions.indexOf(t);i>=0&&this.collisions.splice(i,1)}},{key:"update",value:function(t){var i,e,s=document.getElementById(this.IsFaceUp?this.Id:"card-back");(s&&t.drawImage(s,this.Left,this.Top,this.Width,this.Height),O.isDebug&&this.Collider&&this.Collider.Enabled&&(t.globalAlpha=.3,t.fillStyle="red",t.fillRect(this.Collider.Left,this.Collider.Top,this.Collider.Width,this.Collider.Height),t.globalAlpha=1,this.createText(t,"(".concat(Math.round(this.Collider.Left),", ").concat(Math.round(this.Collider.Top),", ").concat(this.Collider.Width,", ").concat(this.Collider.Height,")"),8,this.Left,this.Top+this.Height+10)),O.isDebug)&&(this.createText(t,"".concat(this.Description),10,this.Left+20,this.Top+10),this.createText(t,"P: ".concat(null===(i=this.PreviousCard)||void 0===i?void 0:i.Description),8,this.Left+20,this.Top+20),this.createText(t,"N: ".concat(null===(e=this.NextCard)||void 0===e?void 0:e.Description),8,this.Left+20,this.Top+30))}},{key:"flip",value:function(){this._isFaceUp=!this._isFaceUp}}]),e}(y),_=function(t){Object(d.a)(e,t);var i=Object(v.a)(e);function e(){return Object(l.a)(this,e),i.apply(this,arguments)}return Object(u.a)(e,[{key:"canAddCard",value:function(t){return!1}},{key:"draw",value:function(){this.drawCards(3,!1),B.Moves=B.Moves+1}},{key:"onUpdate",value:function(t){var i=this.Width-40;this.roundedRect(t,this.Left+(this.Width-i)/2,this.Top+(this.Height-i)/2,i,i,i/2),t.globalAlpha=.2,t.fillStyle="transparent",t.fill(),t.strokeStyle="white",t.lineWidth=9,t.stroke(),t.globalAlpha=1}},{key:"updateStack",value:function(){var t=this;if(this.Behaviors.length>0){var i=this.Behaviors[this.Behaviors.length-1];i&&(i.Visible=!0,i.IsClickable=!0,i.onClick=function(i){t.draw()})}}}]),e}(b),w=function(t){Object(d.a)(e,t);var i=Object(v.a)(e);function e(){return Object(l.a)(this,e),i.apply(this,arguments)}return Object(u.a)(e,[{key:"canAddCard",value:function(t){return!1}},{key:"updateStack",value:function(){var t=this;if(this.Behaviors.forEach((function(i){if("pick-stack"!==i.Id){var e=i;e&&(e.Left=t.Left,e.Visible=!1,e.IsFaceUp=!1,e.IsClickable=!1,e.IsDragable=!1,e.onClick=function(t){})}})),this.Behaviors.length>0){var i=this.Behaviors.length-3;i<0&&(i=0);for(var e=i;e<this.Behaviors.length;e++){var s=this.Behaviors[e];s.Visible=!0,s.IsFaceUp=!0,s.IsDragable=e===this.Behaviors.length-1,s.Left=s.Left+23*(e-i)}}}}]),e}(b),T=function(t){Object(d.a)(e,t);var i=Object(v.a)(e);function e(){var t;Object(l.a)(this,e);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return(t=i.call.apply(i,[this].concat(n))).suit=void 0,t}return Object(u.a)(e,[{key:"isCompleteStack",value:function(){if(this.Behaviors.length>0){var t=this.Behaviors[this.Behaviors.length-1];if(t instanceof S)return 13===t.Rank}return!1}},{key:"canAddCard",value:function(t){if(0===this.Behaviors.length&&this.suit===t.Suit&&t.IsAce)return this.suit=t.Suit,!0;if(this.suit&&t.Suit===this.suit){var i=this.TopCard;if(i)return i.IsAce&&2===t.Rank||i.Rank+1===t.Rank}return!1}},{key:"onUpdate",value:function(t){if(!this.HasCards&&this.suit){var i=document.getElementById("".concat(this.suit,"-14-stack"));i&&(t.globalAlpha=.1,t.drawImage(i,this.Left,this.Top,this.Width,this.Height),t.globalAlpha=1)}}},{key:"updateStack",value:function(){this.Behaviors.forEach((function(t){t.IsDragable=!1,t.IsClickable=!1,t.Visible=!1})),this.TopCard&&(this.TopCard.Visible=!0)}},{key:"onCollisionEnter",value:function(t){t instanceof S&&(this.IsHighlighted=this.canAddCard(t))}},{key:"onCollisionLeave",value:function(t){this.IsHighlighted=!1}},{key:"Suit",get:function(){return this.suit},set:function(t){this.suit=t}}]),e}(b),P=function(t){Object(d.a)(e,t);var i=Object(v.a)(e);function e(){return Object(l.a)(this,e),i.apply(this,arguments)}return Object(u.a)(e,[{key:"start",value:function(t){}},{key:"stop",value:function(t){}},{key:"update",value:function(t){var i=document.getElementById("play");i&&t.drawImage(i,this.Left,this.Top,this.Width,this.Height)}}]),e}(p),B=function(t){Object(d.a)(e,t);var i=Object(v.a)(e);function e(t){var s;return Object(l.a)(this,e),(s=i.call(this,"game")).leftMargin=25,s.topMargin=50,s.columnMargin=10,s.rowMargin=25,s.drawStack=void 0,s.pickStack=void 0,s.aceStack1=void 0,s.aceStack2=void 0,s.aceStack3=void 0,s.aceStack4=void 0,s.stack1=void 0,s.stack2=void 0,s.stack3=void 0,s.stack4=void 0,s.stack5=void 0,s.stack6=void 0,s.stack7=void 0,s.playStacks=void 0,s.isPaused=!1,s.interval=void 0,s.unPause=function(){s.isPaused=!1,s.interval&&clearInterval(s.interval),s.interval=setInterval(s.updateTimer,1e3)},s.pause=function(){s.isPaused=!0,s.interval&&clearInterval(s.interval)},s.settings=t,s}return Object(u.a)(e,[{key:"init",value:function(t){var i=this;this.aceStack1=new T("ace-stack-1",this.getRowPosition(1),this.getColumnPosition(4)),this.aceStack1.Suit=1,this.addBehavior(this.aceStack1),this.aceStack2=new T("ace-stack-2",this.getRowPosition(1),this.getColumnPosition(5)),this.aceStack2.Suit=2,this.addBehavior(this.aceStack2),this.aceStack3=new T("ace-stack-3",this.getRowPosition(1),this.getColumnPosition(6)),this.aceStack3.Suit=3,this.addBehavior(this.aceStack3),this.aceStack4=new T("ace-stack-4",this.getRowPosition(1),this.getColumnPosition(7)),this.aceStack4.Suit=4,this.addBehavior(this.aceStack4),this.playStacks=new Array,this.stack1=new I("stack-1",this.getRowPosition(2),this.getColumnPosition(1)),this.addBehavior(this.stack1),this.playStacks.push(this.stack1),this.stack2=new I("stack-2",this.getRowPosition(2),this.getColumnPosition(2)),this.addBehavior(this.stack2),this.playStacks.push(this.stack2),this.stack3=new I("stack-3",this.getRowPosition(2),this.getColumnPosition(3)),this.addBehavior(this.stack3),this.playStacks.push(this.stack3),this.stack4=new I("stack-4",this.getRowPosition(2),this.getColumnPosition(4)),this.addBehavior(this.stack4),this.playStacks.push(this.stack4),this.stack5=new I("stack-5",this.getRowPosition(2),this.getColumnPosition(5)),this.addBehavior(this.stack5),this.playStacks.push(this.stack5),this.stack6=new I("stack-6",this.getRowPosition(2),this.getColumnPosition(6)),this.addBehavior(this.stack6),this.playStacks.push(this.stack6),this.stack7=new I("stack-7",this.getRowPosition(2),this.getColumnPosition(7)),this.addBehavior(this.stack7),this.playStacks.push(this.stack7),this.drawStack=new _("draw-stack",this.getRowPosition(1),this.getColumnPosition(1)),this.drawStack.IsClickable=!0,this.drawStack.onClick=function(t){var e=i.pickStack.drawCards(i.pickStack.NumberOfCards,!1);e.forEach((function(t){t.IsFaceUp=!1,t.IsDragable=!1})),i.drawStack.addCards(e)},this.drawStack.onDrawCards=function(t){i.pickStack.addCards(t)},this.addBehavior(this.drawStack),this.pickStack=new w("pick-stack",this.getRowPosition(1),this.getColumnPosition(2)),this.addBehavior(this.pickStack);var s=new P("restart-button");s.Left=O.gameWidth-75,s.Top=8,s.Width=35,s.Height=35,s.IsClickable=!0,s.onClick=function(t){i.restart()},this.addBehavior(s);for(var n=new Array,a=4;a>0;a--)for(var o=14;o>1;o--){var h=new S("card-".concat(a,"-").concat(o),a,o);h.Visible=!1,n.push(h)}this.shuffle(n);for(var r=0;r<this.playStacks.length;){for(var c=r;c<this.playStacks.length;c++){var l=n.pop();l&&(l.IsFaceUp=!1,l.Visible=!0,this.playStacks[c].addCard(l))}r+=1}this.playStacks.forEach((function(t){t.IsReady=!0,t.updateStack()})),this.drawStack.addCards(n),this.drawStack.draw(),e.Moves=0,e.TotalSeconds=0,this.interval&&(clearInterval(this.interval),this.interval=void 0),this.interval=setInterval(this.updateTimer,1e3)}},{key:"getColumnPosition",value:function(t){return this.leftMargin+(t-1)*(O.cardWidth+this.columnMargin)}},{key:"getRowPosition",value:function(t){return this.topMargin+(t-1)*(O.cardHeight+this.rowMargin)}},{key:"shuffle",value:function(t){for(var i=t.length-1;i>0;i--){var e=Math.floor(Math.random()*(i+1)),s=[t[e],t[i]];t[i]=s[0],t[e]=s[1]}}},{key:"getTimerDisplay",value:function(){var t=e.TotalSeconds%60,i=Math.round(e.TotalSeconds/60);return"".concat(i<10?"0":"").concat(i,":").concat(t<10?"0":"").concat(t)}},{key:"gameWon",value:function(t){if(this.interval&&clearInterval(this.interval),this.settings){var i=(this.settings.playAreaWidth-300)/2,s=(this.settings.playAreaHeight-200)/2;t.fillStyle="gray",t.fillRect(i,s,300,200),t.beginPath(),t.rect(i,s,300,200),t.lineWidth=2,t.stroke();var n=document.getElementById("clock");n&&t.drawImage(n,i+50,s+25,50,50),t.font="40px Arial",t.fillStyle="black",t.fillText(this.getTimerDisplay(),i+110,s+63);var a=document.getElementById("moves");a&&t.drawImage(a,i+50,s+100,50,50),t.font="40px Arial",t.fillStyle="black",t.fillText("".concat(e.Moves),i+110,s+140)}}},{key:"onUpdate",value:function(t){if(this.aceStack1.isCompleteStack()&&this.aceStack2.isCompleteStack()&&this.aceStack3.isCompleteStack()&&this.aceStack4.isCompleteStack())this.gameWon(t);else{var i=document.getElementById("clock");i&&t.drawImage(i,25,10,25,25),t.font="20px Arial",t.fillStyle="black",t.fillText(this.getTimerDisplay(),55,30);var s=document.getElementById("moves");s&&t.drawImage(s,115,10,25,25),t.font="20px Arial",t.fillStyle="black",t.fillText("".concat(e.Moves),145,30)}}},{key:"updateTimer",value:function(){e.TotalSeconds=e.TotalSeconds+1}}]),e}(C);B.Moves=0,B.TotalSeconds=0;var O=function(t){Object(d.a)(e,t);var i=Object(v.a)(e);function e(){var t;Object(l.a)(this,e);var s=new g("canvas",e.gameWidth,e.gameHeight,!0,"#59C551");return(t=i.call(this,s,[new B(s)],"game")).loadCardImages(),t}return Object(u.a)(e,[{key:"addImage",value:function(t,i){var e=document.getElementById("cards"),s=new Image;s.id=i,s.src=t,e&&e.appendChild(s)}},{key:"loadCardImages",value:function(){var t=document.getElementById("cards"),i=new Image;i.id="card-back",i.src="./images/cards/0.svg",null===t||void 0===t||t.appendChild(i);var e=new Image;e.id="1-14-stack",e.src="./images/cards/1-14-stack.svg",null===t||void 0===t||t.appendChild(e);var s=new Image;s.id="2-14-stack",s.src="./images/cards/2-14-stack.svg",null===t||void 0===t||t.appendChild(s);var n=new Image;n.id="3-14-stack",n.src="./images/cards/3-14-stack.svg",null===t||void 0===t||t.appendChild(n);var a=new Image;if(a.id="4-14-stack",a.src="./images/cards/4-14-stack.svg",null===t||void 0===t||t.appendChild(a),this.addImage("./images/cards/clock.svg","clock"),this.addImage("./images/cards/moves.svg","moves"),this.addImage("./images/cards/play.svg","play"),t)for(var o=4;o>0;o--)for(var h=14;h>1;h--){var r=new Image;r.id="card-".concat(o,"-").concat(h),r.src="./images/cards/".concat(o,"-").concat(h,".svg"),t.appendChild(r)}}}]),e}(f);O.isDebug=!1,O.gameWidth=1e3,O.gameHeight=800,O.cardWidth=125,O.cardHeight=175;var x=function(t){Object(d.a)(e,t);var i=Object(v.a)(e);function e(t){var s;return Object(l.a)(this,e),(s=i.call(this,t)).solitaire=void 0,s.updateTheme=function(t){},s.beforeUnload=function(t){return s.solitaire.pause(),t(),!0},s.solitaire=new O,s.state={},s}return Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this;c.getContext((function(i){t.setState({context:i})})),this.solitaire.start(),c.registerOnThemeChangeHandler(this.updateTheme),c.registerBeforeUnloadHandler(this.beforeUnload),c.registerOnLoadHandler((function(){t.solitaire.unPause(),alert("OnLoad"),c.appInitialization.notifyAppLoaded()}))}},{key:"render",value:function(){return Object(n.jsx)("div",{children:Object(n.jsx)("canvas",{id:"canvas"})})}}]),e}(o.a.Component);var A=function(){return c.initialize(),Object(n.jsx)(x,{})};r.a.render(Object(n.jsx)(o.a.StrictMode,{children:Object(n.jsx)(A,{})}),document.getElementById("root"))},8:function(t,i,e){}},[[16,1,2]]]);
//# sourceMappingURL=main.17a17efc.chunk.js.map